/* INSERÇÃO AUTOMÁTICA DE PLANOS BASEADO NOS PLANOS BASE - PLAXSET PENDENBTES */
/* BEETHOVEN SANTOS NUNES */
DECLARE @FILIAL AS VARCHAR(5)

SELECT DISTINCT ' INSERT INTO ENGEMAN.DOCPLA (CODEMP,CODPLA,CODSET,DESCRICAO) VALUES (1' 
                +','+CAST(PLAMANUT.CODPLA AS VARCHAR)
                +','+CAST(DOCPLABASE.CODSET AS VARCHAR)
                +','''+DOCPLABASE.DESCRICAO
                +''')' + '--'+PLAMANUT.TAG 
                +CHAR(13)+'!' 
                AS '/*INSERT*/' --, PLAMANUT.TAG 
 
FROM ENGEMAN.PLAMANUT
INNER JOIN ENGEMAN.PLAMANUT PLANOBASE ON 2=2 AND PLANOBASE.TAG LIKE 'XXX'
INNER JOIN ENGEMAN.DOCPLA DOCPLABASE ON 3=3 AND DOCPLABASE.CODPLA=PLANOBASE.CODPLA
 
WHERE SUBSTRING(PLAMANUT.TAG,4,LEN(PLAMANUT.TAG))=SUBSTRING(PLANOBASE.TAG,4,LEN(PLANOBASE.TAG))
AND PLAMANUT.CODPLA NOT IN (SELECT CODPLA FROM DOCPLA)